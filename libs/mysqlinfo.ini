[common]
getbinlogs = show binary logs
getdatabases = SELECT
	    schema_name
    FROM
	    information_schema.SCHEMATA
    WHERE
	    schema_name NOT IN ( 'information_schema', 'performance_schema', 'mysql', 'sys' )
getusers = select user from mysql.user where user not in ('mysql.infoschema','mysql.session','mysql.sys')
getuserhost = SELECT
	concat( concat( concat( USER, '@\'' ), HOST ), '\'' )
	FROM
		mysql.USER
	WHERE
		USER NOT IN (
			'mysql.infoschema',
		'mysql.session',
		'mysql.sys')
gettables = SELECT
	    table_name
    FROM
	    information_schema.TABLES
    WHERE
	    1 = 1
getbinlogbasedir = show variables like 'log_bin_basename'
getdbdetail = SELECT
	    schema_name,default_character_set_name,default_collation_name
    FROM
	    information_schema.SCHEMATA
    WHERE
	    schema_name NOT IN ( 'information_schema', 'performance_schema', 'mysql', 'sys' )
getslowlog = show variables like 'slow_query_log_file'
checkdatabaseexsitsql = select user()
[activ_session]
sql = SELECT
		id,
		USER,
		HOST,
		db,
		command,
		time,
		state,
		LEFT ( info, 30 ),
		info
	FROM
		information_schema.PROCESSLIST
	WHERE
		command NOT IN ( 'Daemon', 'Binlog Dump GTID', 'Sleep', 'Binlog Dump' )
		AND USER NOT IN ( 'event_scheduler', 'system user' )
namelist = id,user,host,db,command,time,state,part_info,info

[count_session]
sql = SELECT USER,
		HOST,
		state,
		count(*)
	FROM
		information_schema.PROCESSLIST
	WHERE USER NOT IN ( 'event_scheduler', 'system user' )
	  and command NOT IN ( 'Daemon', 'Binlog Dump GTID', 'Sleep', 'Binlog Dump' )
	GROUP BY
		USER,
		HOST,
		state
namelist = user,host,state,cnt

[info_session]
sql = SELECT
		t1.variable_value,
		t2.variable_value
	FROM
		( SELECT variable_value FROM PERFORMANCE_SCHEMA.global_variables WHERE variable_name = 'max_connections' ) t1
		JOIN ( SELECT variable_value FROM PERFORMANCE_SCHEMA.global_status WHERE variable_name = 'Max_used_connections' ) t2
namelist = max_connect,max_connect_used

[trx_lock]
sql = SELECT
		trx_id,
		trx_state,
		trx_started,
		trx_wait_started,
		trx_mysql_thread_id,
	  	LEFT ( trx_query, 30 ),
		trx_query
	FROM
		information_schema.INNODB_TRX
namelist = trx_id,trx_state,trx_started,trx_wait_started,trx_mysql_thread_id,part_trx_query,trx_query
[info_lock]
sql = SELECT
		engine_transaction_id,
		thread_id,
		object_schema,
		object_name,
		index_name,
		lock_type,
		lock_mode,
		lock_status
	FROM
		PERFORMANCE_SCHEMA.data_locks
namelist = engine_transaction_id,thread_id,object_schema,object_name,index_name,lock_type,lock_mode,lock_status
[block_lock]
sql = SELECT
		t3.trx_mysql_thread_id,
		t3.trx_state,
		t3.trx_started,
		t3.trx_wait_started,
		left(t3.trx_query,40),
		t3.trx_query,
		t2.trx_mysql_thread_id,
		t2.trx_state,
		t2.trx_started,
		t2.trx_wait_started,
		left(t2.trx_query,40),
		t2.trx_query
	FROM
		PERFORMANCE_SCHEMA.data_lock_waits t1
		JOIN information_schema.INNODB_TRX t2 ON t1.REQUESTING_ENGINE_TRANSACTION_ID = t2.trx_id
		join information_schema.INNODB_TRX t3 on t1.blocking_ENGINE_TRANSACTION_ID = t3.trx_id
namelist = s_id,s_state,s_start,s_start_waite,s_part_sql,s_sql,b_id,b_state,b_start,b_start_waite,b_part_sql,b_sql
[users]
sql = select user,host,plugin,password_expired from mysql.user;
namelist = user,host,plugin,password_expired
[databases]
sql = SELECT
		schema_name,
		default_character_set_name,
		default_collation_name
	FROM
		information_schema.schemata
namelist = schema_name,default_character_set_name,default_collation_name
[size_database]
sql = SELECT
		table_schema,
		sum( table_rows ),
		sum(
		TRUNCATE ( data_length / 1024 / 1024, 2 )),
		sum(
		TRUNCATE ( index_length / 1024 / 1024, 2 ))
	FROM
		information_schema.TABLES
	GROUP BY
		table_schema
	ORDER BY
		sum( data_length ) DESC,
		sum( index_length ) DESC
namelist = table_schema,sum_row,size_data,size_index
[size_table]
sql = SELECT
		table_schema ,
		table_name,
		sum( table_rows ),
		sum(
		TRUNCATE ( data_length / 1024 / 1024, 2 )),
		sum(
		TRUNCATE ( index_length / 1024 / 1024, 2 ))
	FROM
		information_schema.TABLES
	GROUP BY
		table_schema,
		table_name
	ORDER BY
		sum( data_length ) DESC,
		sum( index_length ) DESC
		LIMIT 30
namelist = table_schema,table_name,sum_row,size_data,size_index